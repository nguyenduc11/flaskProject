{% extends 'base.html' %}

{% block title %}To Do List{% endblock %}

{% block content %}
<body class="bg-light">
<div class="container">
    <header class="text-center my-4">
        <h1 class="display-4">To-Do List</h1>
    </header>

    <main>
        <section class="mb-5">
            <h2 class="h3 mb-3">Tasks</h2>
            <ul id="task-list" class="list-group">
                {% for task in tasks %}
                <li class="list-group-item">
                    <h5 class="mb-1">{{ task.task }}</h5>
                    <p class="mb-1"><strong>Description:</strong> {{ task.description }}</p>
                    <p class="mb-1"><strong>Priority:</strong> <span class="badge bg-primary">{{ task.priority }}</span>
                    </p>
                    <p class="mb-1"><strong>Status:</strong> <span class="badge bg-secondary">{{ task.status }}</span>
                    </p>
                    <p class="mb-0"><strong>Due Date:</strong> {{ task.due_date }}</p>
                </li>
                {% else %}
                <li class="list-group-item">No tasks found.</li>
                {% endfor %}
            </ul>
        </section>

        <section>
            <h2 class="h3 mb-3">Add a New Task</h2>
            <form id="task-form" action="{{ url_for('to_do_list.create_task') }}" method="post" class="needs-validation"
                  novalidate>
                <div class="mb-3">
                    <label for="task" class="form-label">Task:</label>
                    <input type="text" class="form-control" id="task" name="task" required>
                </div>

                <div class="mb-3">
                    <label for="description" class="form-label">Description:</label>
                    <textarea class="form-control" id="description" name="description" required></textarea>
                </div>

                <div class="mb-3">
                    <label for="priority" class="form-label">Priority:</label>
                    <select class="form-select" id="priority" name="priority">
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="status" class="form-label">Status:</label>
                    <select class="form-select" id="status" name="status">
                        <option value="Pending">Pending</option>
                        <option value="Completed">Completed</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="due_date" class="form-label">Due Date:</label>
                    <input type="date" class="form-control" id="due_date" name="due_date" required>
                </div>

                <button type="submit" class="btn btn-primary">Add Task</button>
            </form>
        </section>
    </main>

    <footer class="text-center mt-5">
        <p>&copy; 2024 Your To-Do List App</p>
    </footer>
</div>


<script>

    // Example JavaScript for handling form submission with AJAX (optional)
    document.getElementById('task-form').addEventListener('submit', function(event) {
        if (!this.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
        }
        this.classList.add('was-validated');

        if (this.checkValidity()) {
            event.preventDefault();
            const formData = new FormData(this);

            fetch('{{ url_for('to_do_list.create_task') }}', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                console.log('Task created:', data);
                // Optionally, update the task list or show a success message
                // For example, you could reload the page or add the new task to the list
                location.reload();
            })
            .catch(error => console.error('Error:', error));
        }
    });
</script>
</body>

{% endblock %}
